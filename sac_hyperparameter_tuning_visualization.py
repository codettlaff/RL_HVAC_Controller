import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# ----------------------------------------------------
# Enter SAC hyperparameter sweep data
# Format: (trial, lr, gamma, batch, tau, ent_coef, loss)
# ----------------------------------------------------

data = [
    (1, 0.0003, 0.95, 64, 0.005, "auto", 1248.31),
    (2, 0.0003, 0.95, 64, 0.005, 0.001, 1441.92),
    (3, 0.0003, 0.95, 64, 0.01, "auto", 1163.78),
    (4, 0.0003, 0.95, 64, 0.01, 0.001, 1441.92),
    (5, 0.0003, 0.95, 128, 0.005, "auto", 1123.62),
    (6, 0.0003, 0.95, 128, 0.005, 0.001, 112281.47),
    (7, 0.0003, 0.95, 128, 0.01, "auto", 1149.38),
    (8, 0.0003, 0.95, 128, 0.01, 0.001, 1441.92),
    (9, 0.0003, 0.95, 256, 0.005, "auto", 1055.06),
    (10, 0.0003, 0.95, 256, 0.005, 0.001, 1441.92),
    (11, 0.0003, 0.95, 256, 0.01, "auto", 2884.36),
    (12, 0.0003, 0.95, 256, 0.01, 0.001, 112281.47),

    (13, 0.0003, 0.98, 64, 0.005, "auto", 1323.38),
    (14, 0.0003, 0.98, 64, 0.005, 0.001, 1441.92),
    (15, 0.0003, 0.98, 64, 0.01, "auto", 27374.69),
    (16, 0.0003, 0.98, 64, 0.01, 0.001, 1441.92),
    (17, 0.0003, 0.98, 128, 0.005, "auto", 997.93),
    (18, 0.0003, 0.98, 128, 0.005, 0.001, 1441.92),
    (19, 0.0003, 0.98, 128, 0.01, "auto", 872.62),
    (20, 0.0003, 0.98, 128, 0.01, 0.001, 1441.92),
    (21, 0.0003, 0.98, 256, 0.005, "auto", 1393.98),
    (22, 0.0003, 0.98, 256, 0.005, 0.001, 112281.47),
    (23, 0.0003, 0.98, 256, 0.01, "auto", 1373.71),
    (24, 0.0003, 0.98, 256, 0.01, 0.001, 1441.92),

    (25, 0.0003, 0.995, 64, 0.005, "auto", 1366.79),
    (26, 0.0003, 0.995, 64, 0.005, 0.001, 1441.92),
    (27, 0.0003, 0.995, 64, 0.01, "auto", 12215.88),
    (28, 0.0003, 0.995, 64, 0.01, 0.001, 1441.92),
    (29, 0.0003, 0.995, 128, 0.005, "auto", 8521.30),
    (30, 0.0003, 0.995, 128, 0.005, 0.001, 112281.47),
    (31, 0.0003, 0.995, 128, 0.01, "auto", 1021.60),
    (32, 0.0003, 0.995, 128, 0.01, 0.001, 1441.92),
    (33, 0.0003, 0.995, 256, 0.005, "auto", 1321.38),
    (34, 0.0003, 0.995, 256, 0.005, 0.001, 1441.92),
    (35, 0.0003, 0.995, 256, 0.01, "auto", 1298.47),
    (36, 0.0003, 0.995, 256, 0.01, 0.001, 1441.92),

    (37, 0.0001, 0.95, 64, 0.005, "auto", 74122.60),
    (38, 0.0001, 0.95, 64, 0.005, 0.001, 8370.10),
    (39, 0.0001, 0.95, 64, 0.01, "auto", 39426.48),
    (40, 0.0001, 0.95, 64, 0.01, 0.001, 112281.47),

    (41, 0.0001, 0.95, 128, 0.005, "auto", 10165.79),
    (42, 0.0001, 0.95, 128, 0.005, 0.001, 1434.08),
    (43, 0.0001, 0.95, 128, 0.01, "auto", 44155.34),
    (44, 0.0001, 0.95, 128, 0.01, 0.001, 109688.59),

    (45, 0.0001, 0.95, 256, 0.005, "auto", 76700.88),
    (46, 0.0001, 0.95, 256, 0.005, 0.001, 3930.64),
    (47, 0.0001, 0.95, 256, 0.01, "auto", 7298.44),
    (48, 0.0001, 0.95, 256, 0.01, 0.001, 109385.89),

    (49, 0.0001, 0.98, 64, 0.005, "auto", 31061.21),
    (50, 0.0001, 0.98, 64, 0.005, 0.001, 1437.61),
    (51, 0.0001, 0.98, 64, 0.01, "auto", 3680.61),
    (52, 0.0001, 0.98, 64, 0.01, 0.001, 1379.08),

    (53, 0.0001, 0.98, 128, 0.005, "auto", 12589.49),
    (54, 0.0001, 0.98, 128, 0.005, 0.001, 38887.80),
    (55, 0.0001, 0.98, 128, 0.01, "auto", 12668.02),
    (56, 0.0001, 0.98, 128, 0.01, 0.001, 1465.16),

    (57, 0.0001, 0.98, 256, 0.005, "auto", 99556.13),
    (58, 0.0001, 0.98, 256, 0.005, 0.001, 104992.77),
    (59, 0.0001, 0.98, 256, 0.01, "auto", 66952.88),
    (60, 0.0001, 0.98, 256, 0.01, 0.001, 81698.86),

    (61, 0.0001, 0.995, 64, 0.005, "auto", 32820.13),
    (62, 0.0001, 0.995, 64, 0.005, 0.001, 112281.47),
    (63, 0.0001, 0.995, 64, 0.01, "auto", 83954.95),
    (64, 0.0001, 0.995, 64, 0.01, 0.001, 112255.53),

    (65, 0.0001, 0.995, 128, 0.005, "auto", 1617.58),
    (66, 0.0001, 0.995, 128, 0.005, 0.001, 1335.19),
    (67, 0.0001, 0.995, 128, 0.01, "auto", 19930.99),
    (68, 0.0001, 0.995, 128, 0.01, 0.001, 1687.67),

    (69, 0.0001, 0.995, 256, 0.005, "auto", 5745.36),
    (70, 0.0001, 0.995, 256, 0.005, 0.001, 1098.02),
    (71, 0.0001, 0.995, 256, 0.01, "auto", 68617.87),
    (72, 0.0001, 0.995, 256, 0.01, 0.001, 1441.92),

    (73, 5e-05, 0.95, 64, 0.005, "auto", 72218.72),
    (74, 5e-05, 0.95, 64, 0.005, 0.001, 1370.66),
    (75, 5e-05, 0.95, 64, 0.01, "auto", 63486.90),
    (76, 5e-05, 0.95, 64, 0.01, 0.001, 111672.43),

    (77, 5e-05, 0.95, 128, 0.005, "auto", 39142.51),
    (78, 5e-05, 0.95, 128, 0.005, 0.001, 58302.37),
    (79, 5e-05, 0.95, 128, 0.01, "auto", 49744.29),
    (80, 5e-05, 0.95, 128, 0.01, 0.001, 111987.62),

    (81, 5e-05, 0.95, 256, 0.005, "auto", 55349.46),
    (82, 5e-05, 0.95, 256, 0.005, 0.001, 1347.48),
    (83, 5e-05, 0.95, 256, 0.01, "auto", 63115.26),
    (84, 5e-05, 0.95, 256, 0.01, 0.001, 1439.93),

    (85, 5e-05, 0.98, 64, 0.005, "auto", 37994.30),
    (86, 5e-05, 0.98, 64, 0.005, 0.001, 75807.54),
    (87, 5e-05, 0.98, 64, 0.01, "auto", 45305.43),
    (88, 5e-05, 0.98, 64, 0.01, 0.001, 1477.84),

    (89, 5e-05, 0.98, 128, 0.005, "auto", 104406.55),
    (90, 5e-05, 0.98, 128, 0.005, 0.001, 101846.08),
    (91, 5e-05, 0.98, 128, 0.01, "auto", 54907.83),
    (92, 5e-05, 0.98, 128, 0.01, 0.001, 55908.23),

    (93, 5e-05, 0.98, 256, 0.005, "auto", 67905.24),
    (94, 5e-05, 0.98, 256, 0.005, 0.001, 69761.60),
    (95, 5e-05, 0.98, 256, 0.01, "auto", 55181.85),
    (96, 5e-05, 0.98, 256, 0.01, 0.001, 1440.02),

    (97, 5e-05, 0.995, 64, 0.005, "auto", 3375.99),
    (98, 5e-05, 0.995, 64, 0.005, 0.001, 7055.95),
    (99, 5e-05, 0.995, 64, 0.01, "auto", 45737.52),
    (100, 5e-05, 0.995, 64, 0.01, 0.001, 112243.48),

    (101, 5e-05, 0.995, 128, 0.005, "auto", 39867.29),
    (102, 5e-05, 0.995, 128, 0.005, 0.001, 923.01),
    (103, 5e-05, 0.995, 128, 0.01, "auto", 50227.00),
    (104, 5e-05, 0.995, 128, 0.01, 0.001, 4626.58),

    (105, 5e-05, 0.995, 256, 0.005, "auto", 40755.74),
    (106, 5e-05, 0.995, 256, 0.005, 0.001, 2564.56),
    (107, 5e-05, 0.995, 256, 0.01, "auto", 76997.09),
    (108, 5e-05, 0.995, 256, 0.01, 0.001, 112240.35),
]

# ----------------------------------------------------
# Create DataFrame
# ----------------------------------------------------
df = pd.DataFrame(data, columns=[
    "trial", "lr", "gamma", "batch", "tau", "ent_coef", "loss"
])

# ----------------------------------------------------
# Build heatmap pivot (gamma × lr)
# ----------------------------------------------------
pivot = df.pivot_table(
    index="gamma",
    columns="lr",
    values="loss",
    aggfunc="mean"
)

# ----------------------------------------------------
# Plot & Save heatmap
# ----------------------------------------------------
plt.figure(figsize=(12, 6))
sns.heatmap(pivot, annot=True, cmap="viridis", fmt=".1f")
plt.title("SAC Hyperparameter Sweep — Mean Loss (gamma vs learning rate)")

output_path = "sac_hyperparam_heatmap.png"
plt.savefig(output_path, dpi=300, bbox_inches="tight")
print(f"Saved SAC heatmap to {output_path}")

plt.show()
