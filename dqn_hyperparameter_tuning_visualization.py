import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# -------------------------------
# Enter the tuning results
# -------------------------------

data = [
    (1, 0.0001, 0.95, 50000, 0.05, 1475.61),
    (2, 0.0001, 0.95, 50000, 0.10, 1830.75),
    (3, 0.0001, 0.95, 50000, 0.20, 1386.25),
    (4, 0.0001, 0.95, 100000, 0.05, 1345.31),
    (5, 0.0001, 0.95, 100000, 0.10, 1546.50),
    (6, 0.0001, 0.95, 100000, 0.20, 1725.59),
    (7, 0.0001, 0.98, 50000, 0.05, 1630.44),
    (8, 0.0001, 0.98, 50000, 0.10, 1441.92),
    (9, 0.0001, 0.98, 50000, 0.20, 1472.75),
    (10, 0.0001, 0.98, 100000, 0.05, 1471.30),
    (11, 0.0001, 0.98, 100000, 0.10, 1543.81),
    (12, 0.0001, 0.98, 100000, 0.20, 1630.44),
    (13, 0.0001, 0.995, 50000, 0.05, 1630.44),
    (14, 0.0001, 0.995, 50000, 0.10, 1307.08),
    (15, 0.0001, 0.995, 50000, 0.20, 1381.33),
    (16, 0.0001, 0.995, 100000, 0.05, 1475.61),
    (17, 0.0001, 0.995, 100000, 0.10, 1543.81),
    (18, 0.0001, 0.995, 100000, 0.20, 1381.33),
    (19, 0.0005, 0.95, 50000, 0.05, 976.27),
    (20, 0.0005, 0.95, 50000, 0.10, 1225.16),
    (21, 0.0005, 0.95, 50000, 0.20, 1113.77),
    (22, 0.0005, 0.95, 100000, 0.05, 1407.63),
    (23, 0.0005, 0.95, 100000, 0.10, 1761.10),
    (24, 0.0005, 0.95, 100000, 0.20, 1441.92),
    (25, 0.0005, 0.98, 50000, 0.05, 1441.92),
    (26, 0.0005, 0.98, 50000, 0.10, 1188.34),
    (27, 0.0005, 0.98, 50000, 0.20, 1366.49),
    (28, 0.0005, 0.98, 100000, 0.05, 1172.38),
    (29, 0.0005, 0.98, 100000, 0.10, 1258.26),
    (30, 0.0005, 0.98, 100000, 0.20, 1543.81),
    (31, 0.0005, 0.995, 50000, 0.05, 1265.18),
    (32, 0.0005, 0.995, 50000, 0.10, 1386.25),
    (33, 0.0005, 0.995, 50000, 0.20, 1629.16),
    (34, 0.0005, 0.995, 100000, 0.05, 1166.09),
    (35, 0.0005, 0.995, 100000, 0.10, 1198.71),
    (36, 0.0005, 0.995, 100000, 0.20, 1441.92),
    (37, 0.001, 0.95, 50000, 0.05, 1229.48),
    (38, 0.001, 0.95, 50000, 0.10, 1335.39),
    (39, 0.001, 0.95, 50000, 0.20, 1138.45),
    (40, 0.001, 0.95, 100000, 0.05, 1289.33),
    (41, 0.001, 0.95, 100000, 0.10, 1441.92),
    (42, 0.001, 0.95, 100000, 0.20, 1032.54),
    (43, 0.001, 0.98, 50000, 0.05, 1215.72),
    (44, 0.001, 0.98, 50000, 0.10, 1441.92),
    (45, 0.001, 0.98, 50000, 0.20, 1441.92),
    (46, 0.001, 0.98, 100000, 0.05, 908.59),
    (47, 0.001, 0.98, 100000, 0.10, 1439.18),
    (48, 0.001, 0.98, 100000, 0.20, 1384.69),
    (49, 0.001, 0.995, 50000, 0.05, 1214.12),
    (50, 0.001, 0.995, 50000, 0.10, 1529.82),
    (51, 0.001, 0.995, 50000, 0.20, 1541.08),
    (52, 0.001, 0.995, 100000, 0.05, 1441.92),
    (53, 0.001, 0.995, 100000, 0.10, 1141.84),
    (54, 0.001, 0.995, 100000, 0.20, 1441.92),
]

df = pd.DataFrame(data, columns=[
    "trial", "lr", "gamma", "buffer", "explore_frac", "loss"
])

print(df.head())


# -------------------------------
# Visualization 1 — Loss by trial
# -------------------------------

plt.figure(figsize=(12,5))
plt.plot(df["trial"], df["loss"], marker='o')
plt.title("Hyperparameter Sweep: Total Loss by Trial")
plt.xlabel("Trial #")
plt.ylabel("Total Loss")
plt.grid(alpha=0.3)
plt.show()


# -------------------------------
# Visualization 2 — Scatter plots
# -------------------------------

fig, axes = plt.subplots(2, 2, figsize=(14,10))

sns.scatterplot(ax=axes[0,0], data=df, x="lr", y="loss", hue="gamma")
axes[0,0].set_title("Loss vs Learning Rate")

sns.scatterplot(ax=axes[0,1], data=df, x="gamma", y="loss", hue="lr")
axes[0,1].set_title("Loss vs Discount Factor")

sns.scatterplot(ax=axes[1,0], data=df, x="buffer", y="loss", hue="lr")
axes[1,0].set_title("Loss vs Buffer Size")

sns.scatterplot(ax=axes[1,1], data=df, x="explore_frac", y="loss", hue="lr")
axes[1,1].set_title("Loss vs Exploration Fraction")

plt.tight_layout()
plt.show()


# -------------------------------
# Visualization 3 — Heatmap grid
# -------------------------------

pivot = df.pivot_table(
    index="gamma",
    columns="lr",
    values="loss",
    aggfunc="mean"
)

plt.figure(figsize=(10,6))
sns.heatmap(pivot, annot=True, cmap="viridis")
plt.title("Average Loss Heatmap: gamma vs. lr")
plt.show()


# -------------------------------
# Best trial
# -------------------------------
best = df.loc[df["loss"].idxmin()]
print("\nBEST TRIAL:")
print(best)
