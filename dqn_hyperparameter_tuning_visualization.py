import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# -------------------------------
# Hyperparameter sweep results
# -------------------------------

dqn_data = [
    (1, 0.0001, 0.95, 50000, 0.05, 1475.61),
    (2, 0.0001, 0.95, 50000, 0.10, 1830.75),
    (3, 0.0001, 0.95, 50000, 0.20, 1386.25),
    (4, 0.0001, 0.95, 100000, 0.05, 1345.31),
    (5, 0.0001, 0.95, 100000, 0.10, 1546.50),
    (6, 0.0001, 0.95, 100000, 0.20, 1725.59),
    (7, 0.0001, 0.98, 50000, 0.05, 1630.44),
    (8, 0.0001, 0.98, 50000, 0.10, 1441.92),
    (9, 0.0001, 0.98, 50000, 0.20, 1472.75),
    (10, 0.0001, 0.98, 100000, 0.05, 1471.30),
    (11, 0.0001, 0.98, 100000, 0.10, 1543.81),
    (12, 0.0001, 0.98, 100000, 0.20, 1630.44),
    (13, 0.0001, 0.995, 50000, 0.05, 1630.44),
    (14, 0.0001, 0.995, 50000, 0.10, 1307.08),
    (15, 0.0001, 0.995, 50000, 0.20, 1381.33),
    (16, 0.0001, 0.995, 100000, 0.05, 1475.61),
    (17, 0.0001, 0.995, 100000, 0.10, 1543.81),
    (18, 0.0001, 0.995, 100000, 0.20, 1381.33),
    (19, 0.0005, 0.95, 50000, 0.05, 976.27),
    (20, 0.0005, 0.95, 50000, 0.10, 1225.16),
    (21, 0.0005, 0.95, 50000, 0.20, 1113.77),
    (22, 0.0005, 0.95, 100000, 0.05, 1407.63),
    (23, 0.0005, 0.95, 100000, 0.10, 1761.10),
    (24, 0.0005, 0.95, 100000, 0.20, 1441.92),
    (25, 0.0005, 0.98, 50000, 0.05, 1441.92),
    (26, 0.0005, 0.98, 50000, 0.10, 1188.34),
    (27, 0.0005, 0.98, 50000, 0.20, 1366.49),
    (28, 0.0005, 0.98, 100000, 0.05, 1172.38),
    (29, 0.0005, 0.98, 100000, 0.10, 1258.26),
    (30, 0.0005, 0.98, 100000, 0.20, 1543.81),
    (31, 0.0005, 0.995, 50000, 0.05, 1265.18),
    (32, 0.0005, 0.995, 50000, 0.10, 1386.25),
    (33, 0.0005, 0.995, 50000, 0.20, 1629.16),
    (34, 0.0005, 0.995, 100000, 0.05, 1166.09),
    (35, 0.0005, 0.995, 100000, 0.10, 1198.71),
    (36, 0.0005, 0.995, 100000, 0.20, 1441.92),
    (37, 0.001, 0.95, 50000, 0.05, 1229.48),
    (38, 0.001, 0.95, 50000, 0.10, 1335.39),
    (39, 0.001, 0.95, 50000, 0.20, 1138.45),
    (40, 0.001, 0.95, 100000, 0.05, 1289.33),
    (41, 0.001, 0.95, 100000, 0.10, 1441.92),
    (42, 0.001, 0.95, 100000, 0.20, 1032.54),
    (43, 0.001, 0.98, 50000, 0.05, 1215.72),
    (44, 0.001, 0.98, 50000, 0.10, 1441.92),
    (45, 0.001, 0.98, 50000, 0.20, 1441.92),
    (46, 0.001, 0.98, 100000, 0.05, 908.59),
    (47, 0.001, 0.98, 100000, 0.10, 1439.18),
    (48, 0.001, 0.98, 100000, 0.20, 1384.69),
    (49, 0.001, 0.995, 50000, 0.05, 1214.12),
    (50, 0.001, 0.995, 50000, 0.10, 1529.82),
    (51, 0.001, 0.995, 50000, 0.20, 1541.08),
    (52, 0.001, 0.995, 100000, 0.05, 1441.92),
    (53, 0.001, 0.995, 100000, 0.10, 1141.84),
    (54, 0.001, 0.995, 100000, 0.20, 1441.92),
]

data = dqn_data
df = pd.DataFrame(data, columns=["trial", "lr", "gamma", "buffer", "explore_frac", "loss"])


# -------------------------------
# Create pivot for heatmap
# -------------------------------

pivot = df.pivot_table(
    index="gamma",
    columns="lr",
    values="loss",
    aggfunc="mean"
)

# -------------------------------
# Plot & save heatmap
# -------------------------------

plt.figure(figsize=(10, 6))
sns.heatmap(pivot, annot=True, cmap="viridis", fmt=".1f")
plt.title("DQN Hyperparameter Sweep â€” Mean Loss (gamma vs lr)")

output_path = "dqn_hyperparam_heatmap.png"
plt.savefig(output_path, dpi=300, bbox_inches='tight')

print(f"Saved heatmap to {output_path}")

plt.show()

