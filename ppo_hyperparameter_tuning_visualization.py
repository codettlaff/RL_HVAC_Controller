import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# ----------------------------------------------------
# Enter PPO hyperparameter sweep data
# Format: (trial, lr, gamma, batch_size, n_steps, loss)
# ----------------------------------------------------

data = [
    (1, 1e-05, 0.95, 64, 256, 1475.61),
    (2, 1e-05, 0.95, 64, 512, 5118.09),
    (3, 1e-05, 0.95, 64, 1024, 1859.42),
    (4, 1e-05, 0.95, 128, 256, 7442.23),
    (5, 1e-05, 0.95, 128, 512, 43966.32),
    (6, 1e-05, 0.95, 128, 1024, 2194.06),
    (7, 1e-05, 0.95, 256, 256, 1441.92),
    (8, 1e-05, 0.95, 256, 512, 18042.10),
    (9, 1e-05, 0.95, 256, 1024, 5899.51),

    (10, 1e-05, 0.98, 64, 256, 42073.53),
    (11, 1e-05, 0.98, 64, 512, 1441.92),
    (12, 1e-05, 0.98, 64, 1024, 35102.48),
    (13, 1e-05, 0.98, 128, 256, 41169.86),
    (14, 1e-05, 0.98, 128, 512, 44049.79),
    (15, 1e-05, 0.98, 128, 1024, 21529.11),
    (16, 1e-05, 0.98, 256, 256, 1441.92),
    (17, 1e-05, 0.98, 256, 512, 4738.81),
    (18, 1e-05, 0.98, 256, 1024, 19888.25),

    (19, 1e-05, 0.995, 64, 256, 1441.92),
    (20, 1e-05, 0.995, 64, 512, 32088.15),
    (21, 1e-05, 0.995, 64, 1024, 3038.16),
    (22, 1e-05, 0.995, 128, 256, 1436.53),
    (23, 1e-05, 0.995, 128, 512, 7775.47),
    (24, 1e-05, 0.995, 128, 1024, 1408.06),
    (25, 1e-05, 0.995, 256, 256, 23342.97),
    (26, 1e-05, 0.995, 256, 512, 1441.92),
    (27, 1e-05, 0.995, 256, 1024, 1640.91),

    (28, 5e-05, 0.95, 64, 256, 1441.92),
    (29, 5e-05, 0.95, 64, 512, 1475.61),
    (30, 5e-05, 0.95, 64, 1024, 1435.89),
    (31, 5e-05, 0.95, 128, 256, 41093.48),
    (32, 5e-05, 0.95, 128, 512, 1441.92),
    (33, 5e-05, 0.95, 128, 1024, 36544.64),
    (34, 5e-05, 0.95, 256, 256, 1317.18),
    (35, 5e-05, 0.95, 256, 512, 1475.61),
    (36, 5e-05, 0.95, 256, 1024, 14406.81),

    (37, 5e-05, 0.98, 64, 256, 3458.39),
    (38, 5e-05, 0.98, 64, 512, 1830.75),
    (39, 5e-05, 0.98, 64, 1024, 1854.80),
    (40, 5e-05, 0.98, 128, 256, 1441.92),
    (41, 5e-05, 0.98, 128, 512, 2617.69),
    (42, 5e-05, 0.98, 128, 1024, 3966.39),
    (43, 5e-05, 0.98, 256, 256, 18324.67),
    (44, 5e-05, 0.98, 256, 512, 1441.92),
    (45, 5e-05, 0.98, 256, 1024, 8125.41),

    (46, 5e-05, 0.995, 64, 256, 31175.91),
    (47, 5e-05, 0.995, 64, 512, 2938.88),
    (48, 5e-05, 0.995, 64, 1024, 1944.79),
    (49, 5e-05, 0.995, 128, 256, 27552.30),
    (50, 5e-05, 0.995, 128, 512, 3350.08),
    (51, 5e-05, 0.995, 128, 1024, 1441.92),
    (52, 5e-05, 0.995, 256, 256, 4464.24),
    (53, 5e-05, 0.995, 256, 512, 1441.92),
    (54, 5e-05, 0.995, 256, 1024, 44049.79),

    (55, 1e-4, 0.95, 64, 256, 1630.44),
    (56, 1e-4, 0.95, 64, 512, 1357.22),
    (57, 1e-4, 0.95, 64, 1024, 1475.61),
    (58, 1e-4, 0.95, 128, 256, 2196.16),
    (59, 1e-4, 0.95, 128, 512, 1441.92),
    (60, 1e-4, 0.95, 128, 1024, 1441.92),
    (61, 1e-4, 0.95, 256, 256, 1441.92),
    (62, 1e-4, 0.95, 256, 512, 10301.74),
    (63, 1e-4, 0.95, 256, 1024, 1441.92),

    (64, 1e-4, 0.98, 64, 256, 1546.50),
    (65, 1e-4, 0.98, 64, 512, 1944.79),
    (66, 1e-4, 0.98, 64, 1024, 2474.58),
    (67, 1e-4, 0.98, 128, 256, 1441.92),
    (68, 1e-4, 0.98, 128, 512, 2654.59),
    (69, 1e-4, 0.98, 128, 1024, 1441.92),
    (70, 1e-4, 0.98, 256, 256, 4240.16),
    (71, 1e-4, 0.98, 256, 512, 1944.79),
    (72, 1e-4, 0.98, 256, 1024, 34313.36),

    (73, 1e-4, 0.995, 64, 256, 5431.43),
    (74, 1e-4, 0.995, 64, 512, 1944.79),
    (75, 1e-4, 0.995, 64, 1024, 24491.10),
    (76, 1e-4, 0.995, 128, 256, 1546.50),
    (77, 1e-4, 0.995, 128, 512, 1441.92),
    (78, 1e-4, 0.995, 128, 1024, 1441.92),
    (79, 1e-4, 0.995, 256, 256, 1830.75),
    (80, 1e-4, 0.995, 256, 512, 1441.92),
    (81, 1e-4, 0.995, 256, 1024, 1386.25),

    (82, 5e-4, 0.95, 64, 256, 1441.92),
    (83, 5e-4, 0.95, 64, 512, 1441.92),
    (84, 5e-4, 0.95, 64, 1024, 1441.92),
    (85, 5e-4, 0.95, 128, 256, 1441.92),
    (86, 5e-4, 0.95, 128, 512, 1441.92),
    (87, 5e-4, 0.95, 128, 1024, 1441.92),
    (88, 5e-4, 0.95, 256, 256, 1441.92),
    (89, 5e-4, 0.95, 256, 512, 1630.44),
    (90, 5e-4, 0.95, 256, 1024, 1475.61),

    (91, 5e-4, 0.98, 64, 256, 1441.92),
    (92, 5e-4, 0.98, 64, 512, 1441.92),
    (93, 5e-4, 0.98, 64, 1024, 1546.50),
    (94, 5e-4, 0.98, 128, 256, 1441.92),
    (95, 5e-4, 0.98, 128, 512, 1546.50),
    (96, 5e-4, 0.98, 128, 1024, 1441.92),
    (97, 5e-4, 0.98, 256, 256, 1546.50),
    (98, 5e-4, 0.98, 256, 512, 1441.92),
    (99, 5e-4, 0.98, 256, 1024, 1441.92),

    (100, 5e-4, 0.995, 64, 256, 1441.92),
    (101, 5e-4, 0.995, 64, 512, 1441.92),
    (102, 5e-4, 0.995, 64, 1024, 1386.25),
    (103, 5e-4, 0.995, 128, 256, 1386.25),
    (104, 5e-4, 0.995, 128, 512, 1475.61),
    (105, 5e-4, 0.995, 128, 1024, 1546.50),
    (106, 5e-4, 0.995, 256, 256, 1830.75),
    (107, 5e-4, 0.995, 256, 512, 1441.92),
    (108, 5e-4, 0.995, 256, 1024, 1381.33),
]

# Create DataFrame
df = pd.DataFrame(data, columns=["trial", "lr", "gamma", "batch", "n_steps", "loss"])

# ----------------------------------------------------
# Build heatmap pivot (gamma × lr)
# ----------------------------------------------------
pivot = df.pivot_table(
    index="gamma",
    columns="lr",
    values="loss",
    aggfunc="mean"
)

# ----------------------------------------------------
# Plot & Save heatmap
# ----------------------------------------------------
plt.figure(figsize=(12, 6))
sns.heatmap(pivot, annot=True, cmap="viridis", fmt=".1f")
plt.title("PPO Hyperparameter Sweep — Mean Loss (gamma vs learning rate)")

output_path = "ppo_hyperparam_heatmap.png"
plt.savefig(output_path, dpi=300, bbox_inches="tight")
print(f"Saved PPO heatmap to {output_path}")

plt.show()
